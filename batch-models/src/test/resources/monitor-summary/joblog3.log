{"eid":"JOB_START","ets":1583368523366,"ver":"3.0","mid":"2D1D6774E11DE425C95B91940D47C2E5","actor":{"id":"","type":"System"},"context":{"channel":"in.ekstep","pdata":{"id":"AnalyticsDataPipeline","ver":"1.0","pid":"WorkFlowSummaryModel"},"env":"analytics"},"edata":{"data":{"config":{"search":{"type":"azure","queries":[{"bucket":"telemetry-data-store","prefix":"unique/","endDate":"2020-03-04","delta":0}]},"filters":[{"name":"eid","operator":"NIN","value":["JOB_START","JOB_END"]}],"model":"org.ekstep.analytics.model.WorkflowSummary","modelParams":{"apiVersion":"v2"},"output":[{"to":"azure","params":{"bucket":"telemetry-data-store","key":"transient-data/wfs/2020-03-04"}},{"to":"kafka","params":{"brokerList":"11.3.2.6:9092","topic":"ntpstaging.telemetry.derived"}}],"parallelization":8,"appName":"Workflow Summarizer","deviceMapping":true},"model":"WorkFlowSummaryModel","date":"2020-03-04"},"message":"Started processing of WorkFlowSummaryModel","class":"org.ekstep.analytics.framework.driver.BatchJobDriver","level":"INFO"},"@timestamp":"2020-03-05T00:35:23+00:00"}
{"eid":"JOB_END","ets":1583368554032,"ver":"3.0","mid":"1A6063A53065A589ABB8EB4B74141261","actor":{"id":"","type":"System"},"context":{"channel":"in.ekstep","pdata":{"id":"AnalyticsDataPipeline","ver":"1.0","pid":"WorkFlowSummaryModel"},"env":"analytics"},"edata":{"data":{"model":"WorkFlowSummaryModel","date":"2020-03-04","inputEvents":111,"statusMsg":"Job aborted due to stage failure: Task 1 in stage 3.0 failed 1 times, most recent failure: Lost task 1.0 in stage 3.0 (TID 18, localhost, executor driver): java.sql.BatchUpdateException: Batch entry 0 INSERT INTO ntpstaging_device_profile (avg_ts,device_id,api_last_updated_on,updated_date,total_ts,first_access,total_launches,last_access) VALUES ('10.12','808f0724f139b65e4a8376e9899ac72f','2020-03-05 00:35:53.897','2020-03-05 00:35:53.897','20.23','2020-03-04 08:45:39.222','2','2020-03-04 08:46:13.678') ON CONFLICT (device_id) DO UPDATE SET (avg_ts,device_id,api_last_updated_on,updated_date,total_ts,first_access,total_launches,last_access) = ('10.12','808f0724f139b65e4a8376e9899ac72f','2020-03-05 00:35:53.897','2020-03-05 00:35:53.897','20.23','2020-03-04 08:45:39.222','2','2020-03-04 08:46:13.678') was aborted.  Call getNextException to see the cause.\n\tat org.postgresql.jdbc2.AbstractJdbc2Statement$BatchResultHandler.handleError(AbstractJdbc2Statement.java:2598)\n\tat org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1836)\n\tat org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:407)\n\tat org.postgresql.jdbc2.AbstractJdbc2Statement.executeBatch(AbstractJdbc2Statement.java:2737)\n\tat org.ekstep.analytics.updater.UpdateDeviceProfileDB$$anonfun$dispatchEventsToPostgres$1.apply(UpdateDeviceProfileDB.scala:107)\n\tat org.ekstep.analytics.updater.UpdateDeviceProfileDB$$anonfun$dispatchEventsToPostgres$1.apply(UpdateDeviceProfileDB.scala:101)\n\tat org.apache.spark.rdd.RDD$$anonfun$foreachPartition$1$$anonfun$apply$28.apply(RDD.scala:935)\n\tat org.apache.spark.rdd.RDD$$anonfun$foreachPartition$1$$anonfun$apply$28.apply(RDD.scala:935)\n\tat org.apache.spark.SparkContext$$anonfun$runJob$5.apply(SparkContext.scala:2101)\n\tat org.apache.spark.SparkContext$$anonfun$runJob$5.apply(SparkContext.scala:2101)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:123)\n\tat org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n\nDriver stacktrace:"},"status":"FAILED","message":"WorkFlowSummaryModel processing failed","class":"org.ekstep.analytics.framework.driver.BatchJobDriver","level":"INFO"},"@timestamp":"2020-03-05T00:35:54+00:00"}
{"eid":"JOB_START","ets":1583368539466,"ver":"3.0","mid":"2CBC04AEBC84C86C5602ACF01A9A46F2","actor":{"id":"","type":"System"},"context":{"channel":"in.ekstep","pdata":{"id":"AnalyticsDataPipeline","ver":"1.0","pid":"DeviceSummaryModel"},"env":"analytics"},"edata":{"data":{"config":{"search":{"type":"azure","queries":[{"bucket":"telemetry-data-store","prefix":"unique/","endDate":"2020-03-04","delta":0},{"bucket":"telemetry-data-store","prefix":"transient-data/wfs/","endDate":"2020-03-04","delta":0,"folder":"true"}]},"model":"org.ekstep.analytics.model.DeviceSummaryModel","modelParams":{"apiVersion":"v2"},"output":[{"to":"azure","params":{"bucket":"telemetry-data-store","key":"transient-data/device-summary/2020-03-04"}},{"to":"kafka","params":{"brokerList":"11.3.2.6:9092","topic":"ntpstaging.telemetry.derived"}}],"parallelization":12,"appName":"Device Summarizer","deviceMapping":false},"model":"DeviceSummaryModel","date":"2020-03-04"},"message":"Started processing of DeviceSummaryModel","class":"org.ekstep.analytics.framework.driver.BatchJobDriver","level":"INFO"},"@timestamp":"2020-03-05T00:35:39+00:00"}
{"eid":"JOB_END","ets":1583368551065,"ver":"3.0","mid":"3D40239BB27EBD9AB4D8E80053A2024C","actor":{"id":"","type":"System"},"context":{"channel":"in.ekstep","pdata":{"id":"AnalyticsDataPipeline","ver":"1.0","pid":"DeviceSummaryModel"},"env":"analytics"},"edata":{"data":{"model":"DeviceSummaryModel","inputEvents":63504,"timeTaken":11.0,"date":"2020-03-04","outputEvents":111},"status":"SUCCESS","message":"DeviceSummaryModel processing complete","class":"org.ekstep.analytics.framework.driver.BatchJobDriver","level":"INFO"},"@timestamp":"2020-03-05T00:35:51+00:00"}
{"eid":"JOB_START","ets":1583368551479,"ver":"3.0","mid":"A4CB7DEBF8631BCAF2B19361A8D78AF2","actor":{"id":"","type":"System"},"context":{"channel":"in.ekstep","pdata":{"id":"AnalyticsDataPipeline","ver":"1.0","pid":"UpdateDeviceProfileDB"},"env":"analytics"},"edata":{"data":{"config":{"search":{"type":"azure","queries":[{"bucket":"telemetry-data-store","prefix":"transient-data/device-summary/","endDate":"2020-03-04","delta":0,"folder":"true"}]},"model":"org.ekstep.analytics.model.UpdateDeviceProfileDB","modelParams":{"apiVersion":"v2"},"output":[{"to":"console","params":{"printEvent":false}}],"parallelization":8,"appName":"Device Profile Updater","deviceMapping":false},"model":"UpdateDeviceProfileDB","date":"2020-03-04"},"message":"Started processing of UpdateDeviceProfileDB","class":"org.ekstep.analytics.framework.driver.BatchJobDriver","level":"INFO"},"@timestamp":"2020-03-05T00:35:51+00:00"}
{"eid":"JOB_END","ets":1583368551065,"ver":"3.0","mid":"3D40239BB27EBD9AB4D8E80053A2024C","actor":{"id":"","type":"System"},"context":{"channel":"in.ekstep","pdata":{"id":"AnalyticsDataPipeline","ver":"1.0","pid":"UpdateDeviceProfileDB"},"env":"analytics"},"edata":{"data":{"model":"UpdateDeviceProfileDB","inputEvents":100,"timeTaken":20.0,"date":"2020-03-04","outputEvents":300},"status":"SUCCESS","message":"UpdateDeviceProfileDB processing complete","class":"org.ekstep.analytics.framework.driver.BatchJobDriver","level":"INFO"},"@timestamp":"2020-03-05T00:35:51+00:00"}
{"eid":"JOB_START","ets":1586938039379,"ver":"3.0","mid":"DC9993EDA720CE0CAEDD3070D4E8856B","actor":{"id":"","type":"System"},"context":{"channel":"in.ekstep","pdata":{"id":"AnalyticsDataPipeline","ver":"1.0","pid":"UsageMetrics","model":null},"env":"analytics","sid":null,"did":null,"cdata":null,"rollup":null},"object":null,"edata":{"data":{"config":{"search":{"type":"none","query":null,"queries":null,"druidQuery":null},"filters":null,"sort":null,"model":"org.ekstep.analytics.model.DruidQueryProcessingModel","modelParams":{"reportConfig":{"id":"usage_metrics","labels":{"state":"State","total_sessions":"Number of Content Plays","producer_id":"Producer","total_scans":"Number of Successful QR Scans","total_ts":"Content Play Time"},"dateRange":{"staticInterval":"LastDay","granularity":"all"},"metrics":[{"metric":"totalSuccessfulScans","label":"Total Scans","druidQuery":{"intervals":"LastDay","dataSource":"telemetry-events","descending":"false","filters":[{"type":"greaterThan","dimension":"edata_size","value":0},{"type":"equals","dimension":"eid","value":"SEARCH"}],"granularity":"day","dimensions":[{"fieldName":"device_loc_state","aliasName":"state"},{"fieldName":"context_pdata_id","aliasName":"producer_id"}],"aggregations":[{"name":"total_scans","fieldName":"count","type":"count"}],"queryType":"groupBy"}},{"metric":"totalSessions/totalContentPlays","label":"Total ContentPlay Sessions","druidQuery":{"intervals":"LastDay","dataSource":"summary-events","descending":"false","filters":[{"type":"in","dimension":"dimensions_pdata_id","values":["prod.sunbird.app","prod.sunbird.portal"]},{"type":"in","dimension":"dimensions_type","values":["content","app"]}],"granularity":"all","dimensions":[{"fieldName":"device_loc_state","aliasName":"state"},{"fieldName":"dimensions_pdata_id","aliasName":"producer_id"}],"aggregations":[{"name":"total_sessions","fieldName":"count","type":"count"},{"name":"total_ts","fieldName":"edata_time_spent","type":"doubleSum"}],"queryType":"groupBy"}}],"output":[{"dims":["state","producer_id"],"fileParameters":["id","dims"],"metrics":["total_scans","total_sessions","total_ts"],"type":"csv"}],"queryType":"groupBy"},"key":"druid-reports/","modelName":"UsageMetrics","filePath":"src/test/resources/","bucket":"test-container"},"output":[{"to":"console","params":{"printEvent":false}}],"parallelization":10,"appName":"TestDruidQueryProcessor","deviceMapping":true,"exhaustConfig":null,"name":null},"model":"UsageMetrics"},"message":"Started processing of UsageMetrics","class":"org.ekstep.analytics.framework.driver.BatchJobDriver","level":"INFO"},"@timestamp":"2020-04-15T08:07:19+00:00"}
{"eid":"JOB_END","ets":1586938044063,"ver":"3.0","mid":"6F35395A657622E84D52602CED1530EB","actor":{"id":"","type":"System"},"context":{"channel":"in.ekstep","pdata":{"id":"AnalyticsDataPipeline","ver":"1.0","pid":"UsageMetrics","model":null},"env":"analytics","sid":null,"did":null,"cdata":null,"rollup":null},"object":null,"edata":{"data":{"model":"DruidQueryProcessingModel","inputEvents":0,"statusMsg":"Tcp command [Connect(localhost:8082,None,List(),Some(10 seconds),true)] failed because of java.net.ConnectException: Connection refused"},"status":"FAILED","message":"DruidQueryProcessingModel processing failed","class":"org.ekstep.analytics.framework.driver.BatchJobDriver","level":"INFO"},"@timestamp":"2020-04-15T08:07:24+00:00"}